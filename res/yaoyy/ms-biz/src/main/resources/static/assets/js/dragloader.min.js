!function(t){var e=t.document,r=t.navigator,o=r.msPointerEnabled,s={start:o?"MSPointerDown":"touchstart",move:o?"MSPointerMove":"touchmove",end:o?"MSPointerUp":"touchend"},n=e.createElement("div").style,i=function(){for(var t,e="t,webkitT,MozT,msT,OT".split(","),r=0,o=e.length;o>r;r++)if(t=e[r]+"ransform",t in n)return e[r].substr(0,e[r].length-1);return!1}(),a=function(t){return""===i?t:(t=t.charAt(0).toUpperCase()+t.substr(1),i+t)},h=a("transition"),d=function(){return"webkit"==i||"O"===i?i.toLowerCase()+"TransitionEnd":"transitionend"}(),l=function(t,e,r){var o=this,s=function(){t.transitionTimer&&clearTimeout(t.transitionTimer),t.transitionTimer=null,t.removeEventListener(d,n,!1)},n=function(){s(),r&&r.call(o)};s(),t.addEventListener(d,n,!1),t.transitionTimer=setTimeout(n,e+100)},c=function(t,r){this.ct=t?"string"==typeof t?e.querySelector(t):t:e.body,r=r||{},this.options=r,"undefined"==typeof r.threshold&&(r.threshold=80),"undefined"==typeof r.dragDownThreshold&&(r.dragDownThreshold=r.threshold),"undefined"==typeof r.dragUpThreshold&&(r.dragUpThreshold=r.threshold),this._events={},this._draggable=!0,this.ct.addEventListener(s.start,this,!1)};c.prototype={STATUS:{"default":"default",prepare:"prepare",load:"load"},_createDragDownRegion:function(){return this._removeDragDownRegion(),this.header=e.createElement("div"),this.header.style.cssText="position:relative;top:0;left:0;margin:0;padding:0;overflow:hidden;width:100%;height:0px;",this.header.className=this.options.dragDownRegionCls||"",this._touchCoords.status=this._processStatus("down",0,null,!0),this.ct.insertBefore(this.header,this.ct.children[0]),this.header},_removeDragDownRegion:function(){this.header&&(this.ct.removeChild(this.header),this.header=null)},_createDragUpRegion:function(){return this._removeDragUpRegion(),this.footer=e.createElement("div"),this.footer.style.cssText="position:relative;bottom:0;left:0;margin:0;padding:0;overflow:hidden;width:100%;height:0px;",this.footer.className=this.options.dragUpRegionCls||"",this._touchCoords.status=this._processStatus("up",0,null,!0),this.ct.appendChild(this.footer),this.footer},_removeDragUpRegion:function(){this.footer&&(this.ct.removeChild(this.footer),this.footer=null)},_processDragDownHelper:function(t){var e=this.options,r=e.dragDownHelper;!e.preventDragHelper&&r&&(this.header.innerHTML=r.call(this,t))},_processDragUpHelper:function(t){var e=this.options,r=e.dragUpHelper;!e.preventDragHelper&&r&&(this.footer.innerHTML=r.call(this,t))},_processStatus:function(t,e,r,o){var s,n,i=this.options,a=this.STATUS,h=r;return t&&(n=t.charAt(0).toUpperCase()+t.substr(1),s=e>i["drag"+n+"Threshold"],s||r==a.default?o&&s&&r!=a.prepare?(this["_processDrag"+n+"Helper"].call(this,a.prepare),this._fireEvent("drag"+n+"Prepare"),h=a.prepare):!o&&s&&r!=a.load&&(this["_processDrag"+n+"Helper"].call(this,a.load),this._fireEvent("drag"+n+"Load"),h=a.load):(this["_processDrag"+n+"Helper"].call(this,a.default),this._fireEvent("drag"+n+"Default"),h=a.default)),h},_onTouchStrat:function(r){this.ct.removeEventListener(s.move,this,!1),this.ct.removeEventListener(s.end,this,!1);var n=e.body,i=this.ct===n?t.pageYOffset||t.scrollY||e.documentElement.scrollTop:this.ct.scrollTop;!this._draggable||this.options.disableDragDown===!0&&this.options.disableDragUp===!0||this._fireEvent("beforeDrag")===!1||(this._draggable=!1,this.ct.addEventListener(s.move,this,!1),this.ct.addEventListener(s.end,this,!1),this._touchCoords={},this._touchCoords.startY=o?r.screenY:r.touches[0].screenY,this._touchCoords.startScrollY=i)},_onTouchMove:function(e){var r,s,n=this.ct,i=this.header,a=this.footer,h=this.options,d=t.innerHeight,l=n.scrollHeight,c=this._touchCoords,p=c.startScrollY,u=c.blockY,g=c.startY,f=o?e.screenY:e.touches[0].screenY;"undefined"==typeof c.canDragDown&&(c.canDragDown=h.disableDragDown!==!0&&f>g&&0>=p),"undefined"==typeof c.canDragUp&&(c.canDragUp=h.disableDragUp!==!0&&g>f&&p+d>=l),c.canDragDown&&c.dragUp!==!0&&(c.dragDown||0>g-f+p)?(e.preventDefault(),c.dragDown=!0,i||(i=this._createDragDownRegion()),"undefined"==typeof u&&(c.blockY=u=f),r=f-u,r=r>0?r:0,s=r-h.dragDownThreshold,s>100?r=h.dragDownThreshold+75+.25*(s-100):s>50&&(r=h.dragDownThreshold+50+.5*(s-50)),i.style.height=r+"px",c.status=this._processStatus("down",r,c.status,!0)):c.canDragUp&&c.dragDown!==!0&&(c.dragUp||g-f+p+d>l)?(e.preventDefault(),c.dragUp=!0,a||(a=this._createDragUpRegion()),"undefined"==typeof u&&(c.blockY=u=f),r=u-f,r=r>0?r:0,s=r-h.dragUpThreshold,s>100?r=h.dragUpThreshold+75+.2*(s-100):s>50&&(r=h.dragUpThreshold+50+.5*(s-50)),n.scrollTop=p+r,a.style.height=r+"px",c.status=this._processStatus("up",r,c.status,!0)):c.blockY=f},_onTouchEnd:function(){this.ct.removeEventListener(s.move,this,!1),this.ct.removeEventListener(s.end,this,!1),this._translate()},_translate:function(){var t,e,r,o,s,n,i,a=this,d=a.options,c=a._touchCoords,p=200,u=function(){c.status=a._processStatus(t,r,c.status,!1),t&&c.status===a.STATUS.load?"down"==t?a._removeDragUpRegion():"up"==t&&(a._removeDragDownRegion(),d.dragUpLoadFn&&d.dragUpLoadFn()):(a._removeDragDownRegion(),a._removeDragUpRegion(),a._touchCoords=null,a._draggable=!0)};c&&(t=c.dragDown?"down":c.dragUp?"up":null,t?(e="down"==t?a.header:a.footer,r=e.offsetHeight,n=t.charAt(0).toUpperCase()+t.substr(1),i=d["drag"+n+"Threshold"],o=!d.preventDragHelper&&r>i?i:0,s=Math.ceil((r-o)/i*p),s=s>p?p:s,l(e,s,u),e.style[h]="height "+s+"ms",setTimeout(function(){e.style.height=o+"px"},0)):u())},reset:function(){this._translate()},on:function(t,e){this._events[t]||(this._events[t]=[]),this._events[t].push(e)},off:function(t,e){this._events[t]&&this._events[t].every(function(r,o){return r===e?(this._events[t].splice(o,1),!1):void 0})},_fireEvent:function(t,e){var r,o=this;return o._events[t]&&o._events[t].forEach(function(t){r=t.apply(o,e||[])}),r},setDragDownDisabled:function(t){this.options.disableDragDown=t},setDragUpDisabled:function(t){this.options.disableDragUp=t},handleEvent:function(t){switch(t.type){case s.start:this._onTouchStrat(t);break;case s.move:this._onTouchMove(t);break;case s.end:this._onTouchEnd(t)}},destroy:function(){this.destroyed||(this.destroyed=!0,this._removeDragDownRegion(),this._removeDragUpRegion(),this.ct.removeEventListener(s.start,this,!1),this.ct.removeEventListener(s.move,this,!1),this.ct.removeEventListener(s.end,this,!1),this.ct=null)}},n=null,t.DragLoader=c}(window);