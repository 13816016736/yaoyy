<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <title>品种列表-药优优</title>
    <link rel="icon" href="favicon.ico">
    <link rel="stylesheet" href="assets/css/app.css">
</head>
<body class="ui-body body-gray">
    <header class="ui-header">
        <div class="title">品种列表</div>
        <div class="abs-l mid">
            <a href="javascript:history.back();" class="fa fa-back"></a>
        </div>
        <div class="abs-r mid search">
            <form id="searchForm">
                <input type="text" value="" class="ipt" />
                <button submit="submit" class="fa fa-search mid submit"></button>
            </form>
        </div>
    </header><!-- /ui-header -->


    <footer class="ui-footer">
        <nav class="ui-nav">
            <ul>
                <li>
                    <a href="index.html">
                        <i class="fa fa-home"></i>
                        <span>首页</span>
                    </a>
                </li>
                <li>
                    <a href="product_list.html">
                        <i class="fa fa-list"></i>
                        <span>品种列表</span>
                    </a>
                </li>
                <li>
                    <a href="pick.html">
                        <i class="fa fa-cart"></i>
                        <span>采购单</span>
                        <b id="cartNum">99</b>
                    </a>
                </li>
                <li>
                    <a href="quote.html">
                        <i class="fa fa-flag"></i>
                        <span>道地行情</span>
                    </a>
                </li>
                <li>
                    <a href="center.html">
                        <i class="fa fa-user"></i>
                        <span>个人中心</span>
                    </a>
                </li>
            </ul>
        </nav>
    </footer>

    <section class="ui-content">
        <div class="plist">
            <dl class="side">
                <dd>热销商品</dd>
                <dd class="curr"><a href="#">白芍</a></dd>
                <dd><a href="#">三棱</a></dd>
                <dd><a href="#">天麻</a></dd>
                <dd><a href="#">白术</a></dd>
                <dd><a href="#">白前</a></dd>
                <dd><a href="#">茯苓</a></dd>
                <dd><a href="#">厚朴</a></dd>
                <dd><a href="#">根茎</a></dd>
                <dd><a href="#">果实籽仁</a></dd>
                <dd><a href="#">全草花叶</a></dd>
                <dd><a href="#">树脂菌藻</a></dd>
                <dd><a href="#">矿石动物</a></dd>
                <dd><a href="#">其他</a></dd>
            </dl>
            <ul id="categroyList">
                <li>
                    <a href="product_detail.html">
                        <div class="cnt">
                            <div class="title">三七</div>
                            <div class="summary">
                                云南文山三七120/80/60头  上等货洗净   无硫  长期供应
                            </div>
                            <div class="price">
                                <i>&yen;</i>
                                <em>380</em>
                                <b>元/公斤</b>
                            </div>
                        </div>
                        <div class="pic">
                            <img src="uploads/p5.jpg" width="110" height="90" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a href="product_detail.html">
                        <div class="cnt">
                            <div class="title">天麻</div>
                            <div class="summary">
                                安徽天麻  无硫  统货  2015版药典标准 长期供应
                            </div>
                            <div class="price">
                                <i>&yen;</i>
                                <em>120</em>
                                <b>元/公斤</b>
                            </div>
                        </div>
                        <div class="pic">
                            <img src="uploads/p6.jpg" width="110" height="90" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a href="product_detail.html">
                        <div class="cnt">
                            <div class="title">当归</div>
                            <div class="summary">
                                甘肃当归  选货  10/12号筛  包加工
                            </div>
                            <div class="price">
                                <i>&yen;</i>
                                <em>140</em>
                                <b>元/公斤</b>
                            </div>
                        </div>
                        <div class="pic">
                            <img src="uploads/p7.jpg" width="110" height="90" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a href="product_detail.html">
                        <div class="cnt">
                            <div class="title">黄连</div>
                            <div class="summary">
                                甘肃定西黄连  10号筛  B级杂质少  干度 好  长期供应
                            </div>
                            <div class="price">
                                <i>&yen;</i>
                                <em>80</em>
                                <b>元/公斤</b>
                            </div>
                        </div>
                        <div class="pic">
                            <img src="uploads/p8.jpg" width="110" height="90" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a href="product_detail.html">
                        <div class="cnt">
                            <div class="title">白芍</div>
                            <div class="summary">
                                安徽亳州白芍  选货  过10-12号筛 
                            </div>
                            <div class="price">
                                <i>&yen;</i>
                                <em>120</em>
                                <b>元/公斤</b>
                            </div>
                        </div>
                        <div class="pic">
                            <img src="uploads/p9.jpg" width="110" height="90" alt="">
                        </div>
                    </a>
                </li>
            </ul>
        </div>
    </section><!-- /ui-content -->

    <script src="assets/js/zepto.min.js"></script>
    <script src="assets/js/app.js"></script>
    <script>

    var _global = {
        fn: {
            init: function() {
                this.bindEvent();
                this.loadPlist();
            },
            bindEvent: function() {
                var self = this;

                $side = $('.side').on('click', 'a', function() {
                    var parameter = {};
                    self.getData(parameter);
                    return false;
                })

            },
            loadPlist: function() {
                var self = this;

                self.pageNum = 1;

                $('.ui-content').dropload({
                    scrollArea : window,
                    threshold : 50,
                    loadDownFn : function(me){
                        self.getData({pageNum:self.pageNum, name: 'b'}, me);                        
                    }
                });
            },
            getData: function(parameter, me) {
                var self = this;
                $.ajax({
                    type: 'GET',
                    url: 'json/plist.json',
                    dataType: 'json',
                    data: parameter,
                    success: function(data){
                        if (!data.list) {
                            return false;
                        }
                        self.toHtml(data.list);
                        if(data.status === 'nomore'){
                            me && me.lock();
                            me && me.noData();
                            me && me.resetload();
                            return;
                        }
                        setTimeout(function(){
                            self.pageNum ++;
                            me && me.resetload();
                        }, 1e3);
                    },
                    error: function(xhr, type){
                        popover('网络连接超时，请您稍后重试!');
                        me && me.resetload();
                    }
                });
            },
            toHtml: function(data) {
                var html = [];
                $.each(data, function(i, item) {
                    html.push('<li>\n');
                    html.push( '<a href="' + data[i].href + '">\n');
                    html.push(     '<div class="cnt">\n');
                    html.push(         '<div class="title">', data[i].title, '</div>\n');
                    html.push(         '<div class="summary">', data[i].summary, '</div>\n');
                    html.push(         '<div class="price">\n');
                    html.push(              '<i>&yen;</i>\n');
                    html.push(              '<em>', data[i].price, '</em>\n');
                    html.push(              '<b>', data[i].unit, '</b>\n');
                    html.push(          '</div>\n');
                    html.push(     '</div>');
                    html.push(     '<div class="pic"><img src="', data[i].pic, '" width="110" height="90" alt="', data[i].title, '"></div>\n');
                    html.push( '</a>\n');
                    html.push('</li>');
                })
                $('#categroyList').append(html.join(''));
            },
            empty: function(isEmpty) {
                if (isEmpty) {
                    $('.ui-content').prepend('<div class="ui-notice ui-notice-extra"> \n 品种列表还没有商品，<br>去商品详情页面可以添加商品到选货单！ \n <a class="ubtn ubtn-primary" href="/">返回首页</a> \n </div>');
                }
            }
        }
    }

    $(function(){
        _global.fn.init();
    });

</script>
</body>
</html>